!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@angular/core"),require("@angular/common"),require("@angular/material")):"function"==typeof define&&define.amd?define(["@angular/core","@angular/common","@angular/material"],t):"object"==typeof exports?exports["angular-croppie-module.umd.min"]=t(require("@angular/core"),require("@angular/common"),require("@angular/material")):e["angular-croppie-module.umd.min"]=t(e["@angular/core"],e["@angular/common"],e["@angular/material"])}(this,function(e,t,n){return function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=4)}([function(e,t,n){"use strict";var i=n(1),o=(n.n(i),n(5)),r=n.n(o);n.d(t,"a",function(){return s});var a=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=function(){function e(e){this.element=e.nativeElement}return e.prototype.ngAfterViewInit=function(){this.croppie=new r.a(this.element,this.croppieOptions)},e.prototype.ngOnDestroy=function(){this.croppie&&this.croppie.destroy()},e}();a([n.i(i.Input)(),l("design:type",Object)],s.prototype,"croppieOptions",void 0),s=a([n.i(i.Directive)({selector:"img[croppieOptions]",exportAs:"croppie"}),l("design:paramtypes",[i.ElementRef])],s)},function(t,n){t.exports=e},function(e,t,n){"use strict";var i=n(1),o=(n.n(i),n(0));n.d(t,"a",function(){return l});var r=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(){function e(){}return Object.defineProperty(e.prototype,"internalCroppieOptions",{get:function(){var e={};return Object.assign(e,this.croppieOptions),e.showZoomer=!1,e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"croppie",{get:function(){return this.croppieDirective.croppie},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoom",{get:function(){return this.croppieDirective.croppie?this.croppieDirective.croppie.get().zoom:1},enumerable:!0,configurable:!0}),e.prototype.onZoom=function(e){this.croppieDirective.croppie&&this.croppieDirective.croppie.setZoom(e.value)},e.prototype.rotateLeft=function(){this.croppieDirective.croppie&&this.croppieDirective.croppie.rotate(-90)},e.prototype.rotateRight=function(){this.croppieDirective.croppie&&this.croppieDirective.croppie.rotate(90)},e}();r([n.i(i.Input)(),a("design:type",Object)],l.prototype,"croppieOptions",void 0),r([n.i(i.ViewChild)("croppie"),a("design:type",o.a)],l.prototype,"croppieDirective",void 0),l=r([n.i(i.Component)({selector:"angular-croppie",template:'\n    <div>\n      <img #croppie="croppie" [croppieOptions]="internalCroppieOptions" />\n    </div>\n    <md-slider *ngIf="croppieOptions.showZoomer" [ngStyle]="{\'width.px\': croppieOptions.boundary.width}" step="0.0001" min="0.0000" max="1.5000" [value]="zoom" (input)="onZoom($event)"></md-slider>\n    <div *ngIf="croppieOptions.enableOrientation" class="rotate-container" [ngStyle]="{\'width.px\': croppieOptions.boundary.width, \'height.px\': croppieOptions.boundary.height}">\n      <button md-mini-fab id="rotate-left" (click)="rotateLeft()"><md-icon>rotate_left</md-icon></button>\n      <button md-mini-fab id="rotate-right" (click)="rotateRight()"><md-icon>rotate_right</md-icon></button>\n    </div>\n  ',styles:["\n    :host {\n        display: flex;\n        flex-flow: column nowrap;\n        align-items: center;\n    }\n\n    .rotate-container {\n        position: absolute;\n    }\n\n    #rotate-left {\n        position: absolute;\n        bottom: 16px;\n        left: 16px;\n        z-index: 1;\n    }\n\n    #rotate-right {\n        position: absolute;\n        bottom: 16px;\n        right: 16px;\n        z-index: 1;\n    }\n  "]}),a("design:paramtypes",[])],l)},function(e,t,n){"use strict";var i=n(1),o=(n.n(i),n(10)),r=(n.n(o),n(11)),a=(n.n(r),n(0)),l=n(2);n.d(t,"a",function(){return c});var s=this&&this.__decorate||function(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a},c=function(){function e(){}return e}();c=s([n.i(i.NgModule)({imports:[o.CommonModule,r.MdButtonModule,r.MdSliderModule,r.MdIconModule],declarations:[a.a,l.a],exports:[a.a,l.a]})],c)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(0);n.d(t,"CroppieDirective",function(){return i.a});var o=n(2);n.d(t,"CroppieComponent",function(){return o.a});var r=n(3);n.d(t,"CroppieModule",function(){return r.a})},function(e,t,n){(function(n){var i,o,r;!function(n,a){o=[t],i=a,void 0!==(r="function"==typeof i?i.apply(t,o):i)&&(e.exports=r)}(0,function(t){function i(e){if(e in A)return e;for(var t=e[0].toUpperCase()+e.slice(1),n=Y.length;n--;)if((e=Y[n]+t)in A)return e}function o(e,t){e=e||{};for(var n in t)t[n]&&t[n].constructor&&t[n].constructor===Object?(e[n]=e[n]||{},o(e[n],t[n])):e[n]=t[n];return e}function r(e){if("createEvent"in document){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0),e.dispatchEvent(t)}else e.fireEvent("onchange")}function a(e,t,n){if("string"==typeof t){var i=t;t={},t[i]=n}for(var o in t)e.style[o]=t[o]}function l(e,t){e.classList?e.classList.add(t):e.className+=" "+t}function s(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"")}function c(e){return parseInt(e,10)}function u(e,t){var n=t||new Image;return n.style.opacity=0,new Promise(function(t){n.src===e?t(n):(n.removeAttribute("crossOrigin"),e.match(/^https?:\/\/|^\/\//)&&n.setAttribute("crossOrigin","anonymous"),n.onload=function(){setTimeout(function(){t(n)},1)},n.src=e)})}function p(e,t){window.EXIF||t(0),EXIF.getData(e,function(){var e=EXIF.getTag(this,"Orientation");t(e)})}function f(e,t,n){var i=t.width,o=t.height,r=e.getContext("2d");switch(e.width=t.width,e.height=t.height,r.save(),n){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,o),r.rotate(180*Math.PI/180);break;case 4:r.translate(0,o),r.scale(1,-1);break;case 5:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.scale(1,-1);break;case 6:e.width=o,e.height=i,r.rotate(90*Math.PI/180),r.translate(0,-o);break;case 7:e.width=o,e.height=i,r.rotate(-90*Math.PI/180),r.translate(-i,o),r.scale(1,-1);break;case 8:e.width=o,e.height=i,r.translate(0,i),r.rotate(-90*Math.PI/180)}r.drawImage(t,0,0,i,o),r.restore()}function h(){var e,t,n,i,o,r=this,s=r.options.viewport.type?"cr-vp-"+r.options.viewport.type:null;r.options.useCanvas=r.options.enableOrientation||d.call(r),r.data={},r.elements={},e=r.elements.boundary=document.createElement("div"),t=r.elements.viewport=document.createElement("div"),r.elements.img=document.createElement("img"),n=r.elements.overlay=document.createElement("div"),r.options.useCanvas?(r.elements.canvas=document.createElement("canvas"),r.elements.preview=r.elements.canvas):r.elements.preview=r.elements.img,l(e,"cr-boundary"),i=r.options.boundary.width,o=r.options.boundary.height,a(e,{width:i+(isNaN(i)?"":"px"),height:o+(isNaN(o)?"":"px")}),l(t,"cr-viewport"),s&&l(t,s),a(t,{width:r.options.viewport.width+"px",height:r.options.viewport.height+"px"}),t.setAttribute("tabindex",0),l(r.elements.preview,"cr-image"),l(n,"cr-overlay"),r.element.appendChild(e),e.appendChild(r.elements.preview),e.appendChild(t),e.appendChild(n),l(r.element,"croppie-container"),r.options.customClass&&l(r.element,r.options.customClass),b.call(this),r.options.enableZoom&&v.call(r)}function d(){return this.options.enableExif&&window.EXIF}function m(e){if(this.options.enableZoom){var t=this.elements.zoomer,n=k(e,4);t.value=Math.max(t.min,Math.min(t.max,n))}}function v(){function e(){g.call(n,{value:parseFloat(o.value),origin:new $(n.elements.preview),viewportRect:n.elements.viewport.getBoundingClientRect(),transform:q.parse(n.elements.preview)})}function t(t){var i,o;i=t.wheelDelta?t.wheelDelta/1200:t.deltaY?t.deltaY/1060:t.detail?t.detail/-60:0,o=n._currentZoom+i*n._currentZoom,t.preventDefault(),m.call(n,o),e.call(n)}var n=this,i=n.elements.zoomerWrap=document.createElement("div"),o=n.elements.zoomer=document.createElement("input");l(i,"cr-slider-wrap"),l(o,"cr-slider"),o.type="range",o.step="0.0001",o.value=1,o.style.display=n.options.showZoomer?"":"none",n.element.appendChild(i),i.appendChild(o),n._currentZoom=1,n.elements.zoomer.addEventListener("input",e),n.elements.zoomer.addEventListener("change",e),n.options.mouseWheelZoom&&(n.elements.boundary.addEventListener("mousewheel",t),n.elements.boundary.addEventListener("DOMMouseScroll",t))}function g(e){function t(){var e={};e[X]=i.toString(),e[W]=r.toString(),a(n.elements.preview,e)}var n=this,i=e?e.transform:q.parse(n.elements.preview),o=e?e.viewportRect:n.elements.viewport.getBoundingClientRect(),r=e?e.origin:new $(n.elements.preview);if(n._currentZoom=e?e.value:n._currentZoom,i.scale=n._currentZoom,t(),n.options.enforceBoundary){var l=y.call(n,o),s=l.translate,c=l.origin;i.x>=s.maxX&&(r.x=c.minX,i.x=s.maxX),i.x<=s.minX&&(r.x=c.maxX,i.x=s.minX),i.y>=s.maxY&&(r.y=c.minY,i.y=s.maxY),i.y<=s.minY&&(r.y=c.maxY,i.y=s.minY)}t(),U.call(n),C.call(n)}function y(e){var t=this,n=t._currentZoom,i=e.width,o=e.height,r=t.elements.boundary.clientWidth/2,a=t.elements.boundary.clientHeight/2,l=t.elements.preview.getBoundingClientRect(),s=l.width,c=l.height,u=i/2,p=o/2,f=-1*(u/n-r),h=f-(s*(1/n)-i*(1/n)),d=-1*(p/n-a),m=d-(c*(1/n)-o*(1/n)),v=1/n*u,g=s*(1/n)-v,y=1/n*p;return{translate:{maxX:f,minX:h,maxY:d,minY:m},origin:{maxX:g,minX:v,maxY:c*(1/n)-y,minY:y}}}function w(){var e=this,t=e._currentZoom,n=e.elements.preview.getBoundingClientRect(),i=e.elements.viewport.getBoundingClientRect(),o=q.parse(e.elements.preview.style[X]),r=new $(e.elements.preview),l=i.top-n.top+i.height/2,s=i.left-n.left+i.width/2,c={},u={};c.y=l/t,c.x=s/t,u.y=(c.y-r.y)*(1-t),u.x=(c.x-r.x)*(1-t),o.x-=u.x,o.y-=u.y;var p={};p[W]=c.x+"px "+c.y+"px",p[X]=o.toString(),a(e.elements.preview,p)}function b(){function e(e,t){var n=h.elements.preview.getBoundingClientRect(),i=f.y+t,o=f.x+e;h.options.enforceBoundary?(p.top>n.top+t&&p.bottom<n.bottom+t&&(f.y=i),p.left>n.left+e&&p.right<n.right+e&&(f.x=o)):(f.y=i,f.x=o)}function t(e){var t=37,i=38,o=39,r=40;if(!e.shiftKey||e.keyCode!=i&&e.keyCode!=r){if(e.keyCode>=37&&e.keyCode<=40){e.preventDefault();var a=function(e){switch(e){case t:return[1,0];case i:return[0,1];case o:return[-1,0];case r:return[0,-1]}}(e.keyCode);f=q.parse(h.elements.preview),document.body.style[H]="none",p=h.elements.viewport.getBoundingClientRect(),n(a)}}else{var l=0;l=e.keyCode==i?parseFloat(h.elements.zoomer.value,10)+parseFloat(h.elements.zoomer.step,10):parseFloat(h.elements.zoomer.value,10)-parseFloat(h.elements.zoomer.step,10),h.setZoom(l)}}function n(t){var n=t[0],i=t[1],o={};e(n,i),o[X]=f.toString(),a(h.elements.preview,o),x.call(h),document.body.style[H]="",w.call(h),C.call(h),u=0}function i(e){if(e.preventDefault(),!d){if(d=!0,s=e.pageX,c=e.pageY,e.touches){var t=e.touches[0];s=t.pageX,c=t.pageY}f=q.parse(h.elements.preview),window.addEventListener("mousemove",o),window.addEventListener("touchmove",o),window.addEventListener("mouseup",l),window.addEventListener("touchend",l),document.body.style[H]="none",p=h.elements.viewport.getBoundingClientRect()}}function o(t){t.preventDefault();var n=t.pageX,i=t.pageY;if(t.touches){var o=t.touches[0];n=o.pageX,i=o.pageY}var l=n-s,p=i-c,d={};if("touchmove"==t.type&&t.touches.length>1){var v=t.touches[0],g=t.touches[1],y=Math.sqrt((v.pageX-g.pageX)*(v.pageX-g.pageX)+(v.pageY-g.pageY)*(v.pageY-g.pageY));u||(u=y/h._currentZoom);var w=y/u;return m.call(h,w),void r(h.elements.zoomer)}e(l,p),d[X]=f.toString(),a(h.elements.preview,d),x.call(h),c=i,s=n}function l(){d=!1,window.removeEventListener("mousemove",o),window.removeEventListener("touchmove",o),window.removeEventListener("mouseup",l),window.removeEventListener("touchend",l),document.body.style[H]="",w.call(h),C.call(h),u=0}var s,c,u,p,f,h=this,d=!1;h.elements.overlay.addEventListener("mousedown",i),h.elements.viewport.addEventListener("keydown",t),h.elements.overlay.addEventListener("touchstart",i)}function x(){var e=this,t=e.elements.boundary.getBoundingClientRect(),n=e.elements.preview.getBoundingClientRect();a(e.elements.overlay,{width:n.width+"px",height:n.height+"px",top:n.top-t.top+"px",left:n.left-t.left+"px"})}function C(){var e,t=this,n=t.get();if(E.call(t))if(t.options.update.call(t,n),t.$&&"undefined"==typeof Prototype)t.$(t.element).trigger("update",n);else{var e;window.CustomEvent?e=new CustomEvent("update",{detail:n}):(e=document.createEvent("CustomEvent"),e.initCustomEvent("update",!0,!0,n)),t.element.dispatchEvent(e)}}function E(){return this.elements.preview.offsetHeight>0&&this.elements.preview.offsetWidth>0}function _(){var e,t,n,i,o,l=this,s=0,c=1.5,u=1,p={},f=l.elements.preview,h=l.elements.zoomer,d=new q(0,0,u),v=new $,g=E.call(l);if(g&&!l.data.bound){if(l.data.bound=!0,p[X]=d.toString(),p[W]=v.toString(),p.opacity=1,a(f,p),e=f.getBoundingClientRect(),t=l.elements.viewport.getBoundingClientRect(),n=l.elements.boundary.getBoundingClientRect(),l._originalImageWidth=e.width,l._originalImageHeight=e.height,l.options.enableZoom){l.options.enforceBoundary&&(i=t.width/e.width,o=t.height/e.height,s=Math.max(i,o)),s>=c&&(c=s+1),h.min=k(s,4),h.max=k(c,4);var y=Math.max(n.width/e.width,n.height/e.height);u=null!==l.data.boundZoom?l.data.boundZoom:y,m.call(l,u),r(h)}else l._currentZoom=u;d.scale=l._currentZoom,p[X]=d.toString(),a(f,p),l.data.points.length?O.call(l,l.data.points):T.call(l),w.call(l),x.call(l)}}function O(e){if(4!=e.length)throw"Croppie - Invalid number of points supplied: "+e;var t=this,n=e[2]-e[0],i=t.elements.viewport.getBoundingClientRect(),o=t.elements.boundary.getBoundingClientRect(),r={left:i.left-o.left,top:i.top-o.top},l=i.width/n,s=e[1],c=e[0],u=-1*e[1]+r.top,p=-1*e[0]+r.left,f={};f[W]=c+"px "+s+"px",f[X]=new q(p,u,l).toString(),a(t.elements.preview,f),m.call(t,l),t._currentZoom=l}function T(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=e.elements.boundary.getBoundingClientRect(),o=n.left-i.left,r=n.top-i.top,l=o-(t.width-n.width)/2,s=r-(t.height-n.height)/2,c=new q(l,s,e._currentZoom);a(e.elements.preview,X,c.toString())}function I(e){var t=this,n=t.elements.canvas,i=t.elements.img,o=n.getContext("2d"),r=d.call(t),e=t.options.enableOrientation&&e;o.clearRect(0,0,n.width,n.height),n.width=i.width,n.height=i.height,r?p(i,function(t){f(n,i,c(t,10)),e&&f(n,i,e)}):e&&f(n,i,e)}function R(e){var t=this,n=e.points,i=c(n[0]),o=c(n[1]),r=c(n[2]),a=c(n[3]),l=r-i,s=a-o,u=e.circle,p=document.createElement("canvas"),f=p.getContext("2d"),h=l,d=s,m=0,v=0,g=h,y=d,w=e.outputWidth&&e.outputHeight,b=1;return w&&(g=e.outputWidth,y=e.outputHeight,b=g/h),p.width=g,p.height=y,e.backgroundColor&&(f.fillStyle=e.backgroundColor,f.fillRect(0,0,h,d)),i<0&&(m=Math.abs(i),i=0),o<0&&(v=Math.abs(o),o=0),r>t._originalImageWidth&&(l=t._originalImageWidth-i,h=l),a>t._originalImageHeight&&(s=t._originalImageHeight-o,d=s),1!==b&&(m*=b,v*=b,h*=b,d*=b),f.drawImage(this.elements.preview,i,o,l,s,m,v,h,d),u&&(f.fillStyle="#fff",f.globalCompositeOperation="destination-in",f.beginPath(),f.arc(h/2,d/2,h/2,0,2*Math.PI,!0),f.closePath(),f.fill()),p}function j(e){var t=e.points,n=document.createElement("div"),i=document.createElement("img"),o=t[2]-t[0],r=t[3]-t[1];return l(n,"croppie-result"),n.appendChild(i),a(i,{left:-1*t[0]+"px",top:-1*t[1]+"px"}),i.src=e.url,a(n,{width:o+"px",height:r+"px"}),n}function M(e){return R.call(this,e).toDataURL(e.format,e.quality)}function L(e){var t=this;return new Promise(function(n,i){R.call(t,e).toBlob(function(e){n(e)},e.format,e.quality)})}function Z(e,t){var n,i=this,o=[],r=null;if("string"==typeof e)n=e,e={};else if(Array.isArray(e))o=e.slice();else{if(void 0===e&&i.data.url)return _.call(i),C.call(i),null;n=e.url,o=e.points||[],r=void 0===e.zoom?null:e.zoom}return i.data.bound=!1,i.data.url=n||i.data.url,i.data.boundZoom=r,u(n,i.elements.img).then(function(n){if(o.length)i.options.relative&&(o=[o[0]*n.naturalWidth/100,o[1]*n.naturalHeight/100,o[2]*n.naturalWidth/100,o[3]*n.naturalHeight/100]),i.data.points=o.map(function(e){return parseFloat(e)});else{var r,a,l=n.naturalWidth,s=n.naturalHeight,c=i.elements.viewport.getBoundingClientRect(),u=c.width/c.height;l/s>u?(a=s,r=a*u):(r=l,a=r/u);var p=(l-r)/2,f=(s-a)/2,h=p+r,d=f+a;i.data.points=[p,f,h,d]}i.options.useCanvas&&(i.elements.img.exifdata=null,I.call(i,e.orientation||1)),_.call(i),C.call(i),t&&t()})}function k(e,t){return parseFloat(e).toFixed(t||0)}function B(){var e=this,t=e.elements.preview.getBoundingClientRect(),n=e.elements.viewport.getBoundingClientRect(),i=n.left-t.left,o=n.top-t.top,r=(n.width-e.elements.viewport.offsetWidth)/2,a=(n.height-e.elements.viewport.offsetHeight)/2,l=i+e.elements.viewport.offsetWidth+r,s=o+e.elements.viewport.offsetHeight+a,c=e._currentZoom;(c===1/0||isNaN(c))&&(c=1);var u=e.options.enforceBoundary?0:Number.NEGATIVE_INFINITY;return i=Math.max(u,i/c),o=Math.max(u,o/c),l=Math.max(u,l/c),s=Math.max(u,s/c),{points:[k(i),k(o),k(l),k(s)],zoom:c}}function P(e){var t=this,n=B.call(t),i=o(V,o({},e)),r="string"==typeof e?e:i.type||"base64",a=i.size,l=i.format,s=i.quality,c=i.backgroundColor,u="boolean"==typeof i.circle?i.circle:"circle"===t.options.viewport.type,p=t.elements.viewport.getBoundingClientRect(),f=p.width/p.height;return"viewport"===a?(n.outputWidth=p.width,n.outputHeight=p.height):"object"==typeof a&&(a.width&&a.height?(n.outputWidth=a.width,n.outputHeight=a.height):a.width?(n.outputWidth=a.width,n.outputHeight=a.width/f):a.height&&(n.outputWidth=a.height*f,n.outputHeight=a.height)),Q.indexOf(l)>-1&&(n.format="image/"+l,n.quality=s),n.circle=u,n.url=t.data.url,n.backgroundColor=c,new Promise(function(e,i){switch(r.toLowerCase()){case"rawcanvas":e(R.call(t,n));break;case"canvas":case"base64":e(M.call(t,n));break;case"blob":L.call(t,n).then(e);break;default:e(j.call(t,n))}})}function F(){_.call(this)}function D(e){if(!this.options.useCanvas)throw"Croppie: Cannot rotate without enableOrientation";var t=this,n=t.elements.canvas,i=(t.elements.img,document.createElement("canvas")),o=1;i.width=n.width,i.height=n.height,i.getContext("2d").drawImage(n,0,0),90!==e&&-270!==e||(o=6),-90!==e&&270!==e||(o=8),180!==e&&-180!==e||(o=3),f(n,i,o),g.call(t)}function S(){var e=this;e.element.removeChild(e.elements.boundary),s(e.element,"croppie-container"),e.options.enableZoom&&e.element.removeChild(e.elements.zoomerWrap),delete e.elements}function z(e,t){if(this.element=e,this.options=o(o({},z.defaults),t),"img"===this.element.tagName.toLowerCase()){var n=this.element;l(n,"cr-original-image");var i=document.createElement("div");this.element.parentNode.appendChild(i),i.appendChild(n),this.element=i,this.options.url=this.options.url||n.src}if(h.call(this),this.options.url){var r={url:this.options.url,points:this.options.points};delete this.options.url,delete this.options.points,Z.call(this,r)}}"function"!=typeof Promise&&function(t){function i(e,t){return function(){e.apply(t,arguments)}}function o(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],u(e,i(a,this),i(l,this))}function r(e){var t=this;return null===this._state?void this._deferreds.push(e):void f(function(){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return void(t._state?e.resolve:e.reject)(t._value);var i;try{i=n(t._value)}catch(t){return void e.reject(t)}e.resolve(i)})}function a(e){try{if(e===this)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var t=e.then;if("function"==typeof t)return void u(i(t,e),i(a,this),i(l,this))}this._state=!0,this._value=e,s.call(this)}catch(e){l.call(this,e)}}function l(e){this._state=!1,this._value=e,s.call(this)}function s(){for(var e=0,t=this._deferreds.length;t>e;e++)r.call(this,this._deferreds[e]);this._deferreds=null}function c(e,t,n,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i}function u(e,t,n){var i=!1;try{e(function(e){i||(i=!0,t(e))},function(e){i||(i=!0,n(e))})}catch(e){if(i)return;i=!0,n(e)}}var p=setTimeout,f="function"==typeof n&&n||function(e){p(e,1)},h=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){var n=this;return new o(function(i,o){r.call(n,new c(e,t,i,o))})},o.all=function(){var e=Array.prototype.slice.call(1===arguments.length&&h(arguments[0])?arguments[0]:arguments);return new o(function(t,n){function i(r,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var l=a.then;if("function"==typeof l)return void l.call(a,function(e){i(r,e)},n)}e[r]=a,0==--o&&t(e)}catch(e){n(e)}}if(0===e.length)return t([]);for(var o=e.length,r=0;r<e.length;r++)i(r,e[r])})},o.resolve=function(e){return e&&"object"==typeof e&&e.constructor===o?e:new o(function(t){t(e)})},o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,n){for(var i=0,o=e.length;o>i;i++)e[i].then(t,n)})},o._setImmediateFn=function(e){f=e},void 0!==e&&e.exports?e.exports=o:t.Promise||(t.Promise=o)}(this),"function"!=typeof window.CustomEvent&&function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(e,t,n){for(var i=atob(this.toDataURL(t,n).split(",")[1]),o=i.length,r=new Uint8Array(o),a=0;a<o;a++)r[a]=i.charCodeAt(a);e(new Blob([r],{type:t||"image/png"}))}});var W,X,H,Y=["Webkit","Moz","ms"],A=document.createElement("div").style;X=i("transform"),W=i("transformOrigin"),H=i("userSelect");var N={translate3d:{suffix:", 0px"},translate:{suffix:""}},q=function(e,t,n){this.x=parseFloat(e),this.y=parseFloat(t),this.scale=parseFloat(n)};q.parse=function(e){return e.style?q.parse(e.style[X]):e.indexOf("matrix")>-1||e.indexOf("none")>-1?q.fromMatrix(e):q.fromString(e)},q.fromMatrix=function(e){var t=e.substring(7).split(",");return t.length&&"none"!==e||(t=[1,0,0,1,0,0]),new q(c(t[4]),c(t[5]),parseFloat(t[0]))},q.fromString=function(e){var t=e.split(") "),n=t[0].substring(z.globals.translate.length+1).split(","),i=t.length>1?t[1].substring(6):1,o=n.length>1?n[0]:0,r=n.length>1?n[1]:0;return new q(o,r,i)},q.prototype.toString=function(){var e=N[z.globals.translate].suffix||"";return z.globals.translate+"("+this.x+"px, "+this.y+"px"+e+") scale("+this.scale+")"};var $=function(e){if(!e||!e.style[W])return this.x=0,void(this.y=0);var t=e.style[W].split(" ");this.x=parseFloat(t[0]),this.y=parseFloat(t[1])};$.prototype.toString=function(){return this.x+"px "+this.y+"px"};var U=function(e,t,n){var i;return function(){var o=this,r=arguments,a=function(){i=null,n||e.apply(o,r)},l=n&&!i;clearTimeout(i),i=setTimeout(a,t),l&&e.apply(o,r)}}(x,500),V={type:"canvas",format:"png",quality:1},Q=["jpeg","webp","png"];if(window.jQuery){var G=window.jQuery;G.fn.croppie=function(e){if("string"==typeof e){var t=Array.prototype.slice.call(arguments,1),n=G(this).data("croppie");return"get"===e?n.get():"result"===e?n.result.apply(n,t):"bind"===e?n.bind.apply(n,t):this.each(function(){var n=G(this).data("croppie");if(n){var i=n[e];if(!G.isFunction(i))throw"Croppie "+e+" method not found";i.apply(n,t),"destroy"===e&&G(this).removeData("croppie")}})}return this.each(function(){var t=new z(this,e);t.$=G,G(this).data("croppie",t)})}}z.defaults={viewport:{width:100,height:100,type:"square"},boundary:{},orientationControls:{enabled:!0,leftClass:"",rightClass:""},customClass:"",showZoomer:!0,enableZoom:!0,mouseWheelZoom:!0,enableExif:!1,enforceBoundary:!0,enableOrientation:!1,update:function(){}},z.globals={translate:"translate3d"},o(z.prototype,{bind:function(e,t){return Z.call(this,e,t)},get:function(){var e=B.call(this),t=e.points;return this.options.relative&&(t[0]/=this.elements.img.naturalWidth/100,t[1]/=this.elements.img.naturalHeight/100,t[2]/=this.elements.img.naturalWidth/100,t[3]/=this.elements.img.naturalHeight/100),e},result:function(e){return P.call(this,e)},refresh:function(){return F.call(this)},setZoom:function(e){m.call(this,e),r(this.elements.zoomer)},rotate:function(e){D.call(this,e)},destroy:function(){return S.call(this)}}),t.Croppie=window.Croppie=z,"object"==typeof e&&e.exports&&(e.exports=z)})}).call(t,n(8).setImmediate)},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function r(e){if(p===clearTimeout)return clearTimeout(e);if((p===i||!p)&&clearTimeout)return p=clearTimeout,clearTimeout(e);try{return p(e)}catch(t){try{return p.call(null,e)}catch(t){return p.call(this,e)}}}function a(){m&&h&&(m=!1,h.length?d=h.concat(d):v=-1,d.length&&l())}function l(){if(!m){var e=o(a);m=!0;for(var t=d.length;t;){for(h=d,d=[];++v<t;)h&&h[v].run();v=-1,t=d.length}h=null,m=!1,r(e)}}function s(e,t){this.fun=e,this.array=t}function c(){}var u,p,f=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{p="function"==typeof clearTimeout?clearTimeout:i}catch(e){p=i}}();var h,d=[],m=!1,v=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new s(e,t)),1!==d.length||m||o(l)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){(function(e,t){!function(e,n){"use strict";function i(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return c[s]=i,l(s),s++}function o(e){delete c[e]}function r(e){var t=e.callback,i=e.args;switch(i.length){case 0:t();break;case 1:t(i[0]);break;case 2:t(i[0],i[1]);break;case 3:t(i[0],i[1],i[2]);break;default:t.apply(n,i)}}function a(e){if(u)setTimeout(a,0,e);else{var t=c[e];if(t){u=!0;try{r(t)}finally{o(e),u=!1}}}}if(!e.setImmediate){var l,s=1,c={},u=!1,p=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?function(){l=function(e){t.nextTick(function(){a(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&a(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),l=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){a(e.data)},l=function(t){e.port2.postMessage(t)}}():p&&"onreadystatechange"in p.createElement("script")?function(){var e=p.documentElement;l=function(t){var n=p.createElement("script");n.onreadystatechange=function(){a(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():function(){l=function(e){setTimeout(a,0,e)}}(),f.setImmediate=i,f.clearImmediate=o}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(9),n(6))},function(e,t,n){function i(e,t){this._id=e,this._clearFn=t}var o=Function.prototype.apply;t.setTimeout=function(){return new i(o.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(7),t.setImmediate=setImmediate,t.clearImmediate=clearImmediate},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,n){e.exports=t},function(e,t){e.exports=n}])});